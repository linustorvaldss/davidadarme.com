---
layout: post
title: "Configurar múltiples cuentas de Git con SSH o dinámicamente con .gitconfig" 
date: "2025-01-01"
category: "Git"
tags: ["git", "github", "gitlab", "workflow", "accounts", "ssh", "keys"]
description: "Configurar y gestionar múltiples cuentas de Git en una sola máquina utilizando claves SSH o de manera dinámica con .gitconfig"
language: "español"
---

El uso de múltiples cuentas de Github o Gitlab en una sola máquina puede ser un poco complicado, ya que cada cuenta requiere un par de claves SSH único. Este post es una pequeña guía educativa que se me ocurrio debido a que me encontré con este problema al querer separar mis cuentas de trabajo y personales en Github.

---

# Configurar con SSH keys



## Crea las SSH keys para cada cuenta
Genera una clave SSH para cada cuenta de Github o Gitlab que tengas. Para ello, ejecuta el siguiente comando en tu terminal:

1. **Genera una clave SSH para la cuenta personal**

```bash
$ ssh-keygen -t ed25519 -C "personal-email" -f "gh-personal-username"
```

Guarda la clave con un nombre diferente, por ejemplo: `~/.ssh/id_ed25519_personal`. Repite el proceso para tu cuenta de trabajo con los mismo comandos:

2. **Genera una clave SSH para la cuenta de trabajo** 

```bash
$ ssh-keygen -t ed25519 -C "business-email" -f "gh-business-username"
```

Asegurate de remplazar:

- `personal-email` y `gh-personal-username`: Por tu correo y nombre de usuario de Github o Gitlab de tu cuenta personal. 
- `business-email` y `gh-business-username`: Por tu correo y nombre de usuario de Github o Gitlab de tu cuenta de trabajo.

Guarda la segunda clave como `~/.ssh/id_ed25519_business`


<div className="alert-warning">
- `-t`: Especifica el tipo de clave que se generará. En este caso, se generará una clave `ed25519`.
- `-C`: Este comentario se incluirá en la clave. Es útil para identificar la clave.
- `-f`: Especifica el nombre del archivo de clave.

Recuerda que esto te genera dos archivos, uno con la extensión `.pub` que es la clave pública y otro sin extensión que es la clave privada. La clave privada es la que debes guardar en tu máquina y la clave pública es la que debes agregar a tu proveedor Git.
</div>

Los tipos de claves que se pueden generar son: `dsa`, `ecdsa`, `ed25519`, `ed25519-sk`, `rsa`. Cada uno tiene sus propias características de seguridad, tamaño de clave, velocidad y compatibilidad. A continuación se muestra una tabla con las características de cada tipo de clave:

<div style={{ overflowX: "auto" }}>
  <Table
    data={{
      headers: ["Algoritmo", "Seguridad", "Tamaño de Clave", "Velocidad"],
      rows: [
          [ "DSA", "Débil", "1024 bits", "Rápido, pero inseguro"],
          [ "ECDSA", "Débil", "256, 384, 521 bits", "Rápido"],
          [ "RSA", "Fuerte", "2048, 3072, 4096 bits", "Lento"],
          [ "ED25519", "Fuerte", "256 bits", "Muy rápido"],
      ],
    }}
  />
</div>

---

## Añadir las SSH keys al agente

Carga ambas claves en el agente SSH:

1. **Inicia el agente SSH en tu terminal:**

```bash
eval "$(ssh-agent -s)"
```
2. **Agrega las claves privadas al agente:**

```bash
$ ssh-add ~/.ssh/id_ed25519_personal
$ ssh-add ~/.ssh/id_ed25519_business
```

Las llaves las agregas al agente para que no tengas que escribir la contraseña cada vez que hagas un push o pull a un repositorio. Esto te permite autenticarte en los servidores sin tener que escribir la contraseña cada vez.

---

## Agregar la clave pública al proveedor Git

Ahora agregaremos nuestra clave pública y la agregaremos a nuestro proveedor de Git correspondiente (En este caso Gitub).

1. **Copia la clave pública que acabas de generar:**

Ubica la clave pública en tu directorio `~/.ssh` y copia su contenido. *Si estás en una terminal, puedes usar el comando `cat filename.pub` para ver el contenido de la clave.*

```bash
$ cd ~/.ssh

# Clave para la cuenta personal
$ cat id_ed25519_personal.pub
ssh-ed25519 AAAAC3NzaC1l*********************************** email@example.com

# Clave para la cuenta personal
$ cat id_ed25519_business.pub
ssh-ed25519 AAAAC3NzaC1l*********************************** email@example.com
```

Luego, ve a tu cuenta de Github y sigue estos pasos:

1. Seleccionamos nuestra foto de perfil ➜ *Setttings* ➜ *SSH and GPG keys* 
![GitHub Settings](/managing-git-accounts/gh_settings.png)

2. Agregamos una nueva clave SSH en ➜ *New SSH key*
![GitHub Settings](/managing-git-accounts/gh_settings_ssh.png)

3. Pegamos la clave pública que copiamos anteriormente y le damos un nombre
![GitHub Settings](/managing-git-accounts/gh_settings_ssh_add.png)

<div className="alert-warning">
- `title`: Título de la clave para identificar las llave SSH que creamos.
- `key type`: Acá podemos elegir que tipo de llave es, si es *Authentication Type* significa que es la clave que vamos a usar para autenticarnos en el servidor, si es *Signing Key* significa que es para firmar tus commits y tags digitalmente. En este caso, seleccionamos *Authentication type*. 
- `key`: la clave pública que copiamos anteriormente.
</div>

--- 

## Crea un archivo de configuración y agrega las entradas de host

El `~/.ssh/config` es un archivo de texto plano que contiene configuraciones de los hosts a los que te conectas. En este archivo, puedes definir diferentes configuraciones para diferentes hosts. En nuestro caso, vamos a definir dos hosts, uno para nuestra cuenta personal y otro para nuestra cuenta de trabajo.

1. **Crea un archivo `config` en el directorio `~/.ssh`:** Si el archivo `config` no existe, crea uno.

```bash
cd ~/.ssh
touch config
vim config # Abre el archivo con tu editor de texto favorito
```

2. **Agrega las siguientes líneas al archivo, cada bloque corresponde a cada cuenta que creamos anteriormente:**

```bash
# config
# Cuenta personal
Host github.com-ghBusinessUsername
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_personal.pub

# Cuenta de trabajo
Host github.com-ghPersonalUsername
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_business.pub
```
<div className="alert-warning">
- `Host`: Nombre de la conexión configurada
- `HostName`: IP-Hostname del servidor al que te conectas 
- `User`: Usuario local del sistema.
- `IdentityFile`: la ruta de llave SSH publica que usaremos para autenticarnos en el servidor.
</div>


3. **Prueba la conexión:**

```bash
ssh -T git@github-trabajo
ssh -T git@github-personal
```

## Clonar repositorios de GitHub usando diferentes cuentas

So we are done with our setups and now its time to see it in action. We will clone a repository using one of the account we have added.

Make a new project folder where you want to clone your repository and go to that directory from your terminal.

For Example: I am making a repository on my personal github account and naming it TestRepo Now for cloning the repo use the below command:


```bash
# Clonar un repositorio desde la cuenta de trabajo
git clone git@github-account-profile:username/repo-name.git

#Ejemplo: 
git clone git@github.com-rahul-personal:rahul-personal/repository.git
```

1. For account1-username having repo  ssh link  -> 
```bash
git@github.com:account1-username/repo.git
```
a. replace github.com with Host in config file with respective account, for account1-username -> account1


```bash
git clone git@account1:account1-username.git
```

```bash
2. For account2-username haveing repo ssh link -> git@github.com:account2-username/repo.git
    a. replace github.com with Host in config file with respective account, for account2-username -> account2
    > git clone git@account2:account2-username.git

```






If you already have a repository cloned you just need to set the username and email for each repository to push or pull to the correct account

```bash
git remote set-url origin git@github-account-profile:username/repo-name.git
```


Confirma que las conexiones SSH funcionan para el repositorio:

```bash
git remote -v
```



```bash
# Cuenta personal
git config user.name "your-personal-username"
git config user.email "your-personal-email"

# Cuenta de trabajo
git config user.name "your-office-username"
git config user.email "your-office-email"
```


Tu carpeta `~/.ssh` debería verse algo así:

```bash
├── .ssh/
│   ├── config # -> Config file
│   └── id_ed25519_personal
│   └── id_ed25519_office
│   └── id_ed25519_personal.pub
│   └── id_ed25519_office.pub
│   └── known_hosts # -> Donde se almacenan los host a los que te has conectado
```





# Configurar con .gitconfig

## Definir rutas de trabajo y personales

Ahora a nuestro archivo `.gitconfig` el que es el general, el archivo base, le agregaremos las siguientes lineas:


```bash
[include]
  # Valor por default para git; de esta manera, por defecto siempre usaremos nuestra cuenta personal
  path = ~/.gitconfig.personal

[includeIf "gitdir:~/Trabajo/"]
  # Todos los proyectos que descarguemos o creemos a partir de esta ruta, usara tu cuenta de tu trabajo
  path = ~/.gitconfig.trabajo

[includeIf "gitdir:~/Personal/"]
  # Todos los proyectos que descarguemos o creemos a partir de esta ruta, usara tu cuenta personal
  # este bloque es opcional, pero debes de asegurarte de colocar el primer bloque.
  path = ~/.gitconfig.personal

[init]
  defaultBranch = main

...
[other configs]
...

```


## Conclusión
That was a quick overview of all the tools I use on a day-to-day basis for coding. I think it's really important to spend some time working on your workflow and coding setup, it will make you faster over time. I hope you found the tools I listed useful and will incorporate them in your workflow too!

Thanks for reading!

## Referencias
1. [What Is ssh-keygen?](https://www.ssh.com/academy/ssh/keygen)
2. [Uso del archivo de configuración SSH](https://linuxize.com/post/using-the-ssh-config-file/) 